
<HTML>
<HEAD>
<LINK rel="stylesheet" href="../exer.css">
</HEAD>
<BODY>
<H1>
Data Structures, Algorithms, & Applications in C++<BR>
Chapter 15, Exercise 3<BR>
<BR>
</H1>


We use the node format <code class=var>[balance factor, key]</code>.
The first two inserts result in the following
balanced trees.
<br>
<pre class=figure>
[0, 20]                [1, 20]
                       /
                   [0, 10]
</pre>
Immediately after the insertion of <code class=var>5</code>, we
have the unbalanced tree
<br><pre class=figure>
                [2, 20] A node
                 /
             [1, 10]
              /
          [0, 5]
</pre>
The nearest ancestor of the newly inserted node whose balance factor
is <code class=var>+2</code> or <code class=var>-2</code> is
<code class=var>[2, 20]</code>. So this node is the <code class=var>A</code>
node.
The imbalance is an LL imbalance because the new node was inserted into
the left subtree of the left subtree of <code class=var>A</code>.
The tree following an LL rotation is shown below.
<br><pre class=figure>
              [0, 10]
             /       \
         [0, 5]     [0, 20]
</pre>
When <code class=var>30</code> is inserted we get the following tree:
<br><pre class=figure>
              [-1, 10]
             /       \
         [0, 5]     [-1, 20]
                         \
                       [0, 30]
</pre>
The insertion of <code class=var>40</code> gives us the unbalanced tree
<br><pre class=figure>
              [-2, 10]
             /       \
         [0, 5]     [-2, 20] A node
                         \
                       [-1, 30]
                            \
                          [0, 40]
</pre>
The imbalance type is RR, and following an RR rotation we get the balanced tree
<br><pre class=figure>
              [-1, 10]
             /       \
         [0, 5]     [0, 30]
                   /       \
              [0, 20]      [0, 40]
</pre>
Following the insertion of <code class=var>3</code> we have the balanced tree
<br><pre class=figure>
              [0, 10]
             /       \
         [1, 5]     [0, 30]
        /          /       \
     [0, 3]    [0, 20]    [0, 40]
</pre>
No rotation is done.
When <code class=var>4</code> is inserted we get the unbalanced tree
<br><pre class=figure>
              [1, 10]
             /       \
 A node   [2, 5]     [0, 30]
        /          /       \
    [-1, 3]    [0, 20]    [0, 40]
        \
       [0, 4]
</pre>
The imbalance type is LR. The balanced tree following an LR rotation
is shown below.
<br><pre class=figure>
                    [0, 10]
                 /           \
               /              \
             /                 \
         [0, 4]              [0, 30]
        /      \            /       \
    [0, 3]   [0, 5]    [0, 20]    [0, 40]
</pre>
When <code class=var>25</code> is inserted we get the balanced tree
<br><pre class=figure>
                    [-1, 10]
                 /           \
               /              \
             /                 \
         [0, 4]              [1, 30]
        /      \            /       \
    [0, 3]   [0, 5]    [-1, 20]    [0, 40]
                            \
                           [0, 25]
</pre>
The insertion of <code class=var>23</code> gives us the unbalanced tree
<br><pre class=figure>
                    [-2, 10]
                 /           \
               /              \
             /                 \
         [0, 4]              [2, 30]
        /      \            /       \
    [0, 3]   [0, 5]    [-2, 20] A   [0, 40]
                            \
                           [1, 25]
                            /
                         [0, 23]
</pre>
The imbalance type is RL. The balanced tree resulting from an RL rotation
<br><pre class=figure>
                    [-1, 10]
                 /           \
               /              \
             /                 \
         [0, 4]              [1, 30]
        /      \            /       \
    [0, 3]   [0, 5]    [0, 23]     [0, 40]
                      /       \
                   [0, 20]   [0, 25]
</pre>
The insertion of <code class=var>27</code> gives us the unbalanced tree
<br><pre class=figure>
                    [-2, 10]
                 /           \
               /              \
             /                 \
         [0, 4]              [2, 30] A node
        /      \            /       \
    [0, 3]   [0, 5]    [-1, 23] B   [0, 40]
                      /       \
                   [0, 20]   [-1, 25] C
                                \
                              [0, 27]
</pre>
This is an LR imbalance and following an LR rotation, we get the
balanced tree
<br><pre class=figure>
                    [-1, 10]
                 /           \
               /              \
             /                 \
         [0, 4]              [0, 25]
        /      \            /       \
    [0, 3]   [0, 5]    [1, 23]     [0, 30]
                      /           /       \
                   [0, 20]   [0, 27]    [0, 40]
</pre>
The insertion of <code class=var>50</code> gives us the unbalanced tree
<br><pre class=figure>
                    [-2, 10] A node
                 /           \
               /              \
             /                 \
         [0, 4]              [-1, 25]
        /      \            /       \
    [0, 3]   [0, 5]    [1, 23]     [-1, 30]
                      /           /       \
                   [0, 20]   [0, 27]    [-1, 40]
                                            \
                                          [0, 50]
</pre>
The imbalance type is RR, and following an RR rotation we get
<br><pre class=figure>
                               [0, 25]
                            /           \
                           /             \
                     [0, 10]              [-1, 30]
                 /          \            /        \
               /             \          /          \
             /                \        /            \
         [0, 4]            [1, 23]   [0, 27]       [-1, 40]
        /      \            /                         \
    [0, 3]   [0, 5]    [0, 20]                      [0, 50]
</pre>


</FONT>
</BODY>
</HTML>
